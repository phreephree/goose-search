{% extends "base.html" %}
{% load static %}
{% load geo_extras %}

{% block content %}
    <h2>Résultats de la recherche</h2>
    <div class="alert alert-info" role="complementary">
        <p>Voici votre localisation estimée :</p>
        <ul>
            <li>Latitude : {{ user_coords.0|render_coordinate }}</li>
            <li>Longitude : {{ user_coords.1|render_coordinate }}</li>
            <li>Adresse : {{ user_address }}</li>
        </ul>
        <br/>
        <p>Recherche : {{ search_description }}</p>
        <br/>
        <p>Les résultats sont triés par ordre croissant de distance par rapport à votre position. Les liens de guidage sont prévus pour des piétons.</p>
    </div>
    <form action="{% url 'home' %}"><input type="submit" value="Nouvelle recherche" class="btn btn-primary btn-mobile btn-sharp btn-block"></form>
    <br/>
    <form id="results_filters">
    </form>
    <hr>
    <!-- Search Glyphicon from http://glyphicons.com/ -->
    <div id="geo_results" aria-busy="true">
        <div class="sk-circle" id="loading-animation">
            <div class="sk-circle1 sk-child"></div>
            <div class="sk-circle2 sk-child"></div>
            <div class="sk-circle3 sk-child"></div>
            <div class="sk-circle4 sk-child"></div>
            <div class="sk-circle5 sk-child"></div>
            <div class="sk-circle6 sk-child"></div>
            <div class="sk-circle7 sk-child"></div>
            <div class="sk-circle8 sk-child"></div>
            <div class="sk-circle9 sk-child"></div>
            <div class="sk-circle10 sk-child"></div>
            <div class="sk-circle11 sk-child"></div>
            <div class="sk-circle12 sk-child"></div>
        </div>
        <center><h3>Recherche…</h3></center>
        <br>
    </div>
    <link rel="stylesheet" type="text/css" href="{% static 'css/loading-animation.css' %}" />
    <script type="text/javascript" src="{% static 'js/search_filters.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/search_ajax.js' %}"></script>
    <script type="text/javascript">
        var userLatitude = {{ user_coords.0|render_coordinate }};
        var userLongitude = {{ user_coords.1|render_coordinate }};
        var radius = {{ radius }};
        var searchPresetId = {{ search_preset_id }};
        var no_private = {{ no_private|render_bool_js }};
        var was_limited = {{ was_limited|render_bool_js }};
        $(document).ready(function() {
            request_results(radius, userLatitude, userLongitude, searchPresetId, no_private, was_limited);
        });
    </script>
    
{% endblock %}
